{% extends 'base.html' %}
{% load custom_tags %}

{% block title %}–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞{% endblock %}

{% block content %}
<h1>–ü–û–î–û–ë–†–ê–¢–¨ –ê–í–¢–û–ú–û–ë–ò–õ–¨</h1>

<div class="link">
    <a href="{% url 'news_list' %}">–ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–≤–µ–∂–∏–º –Ω–æ–≤–æ—Å—Ç—è–º...</a>
</div>

<div class="container">

    <!-- —à–∞–±–ª–æ–Ω–Ω—ã–µ —Ç–µ–≥–∏-->
    <p>–í—Å–µ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π: {% count_total_autos %}</p>
    <p>–ê–≤—Ç–æ–º–æ–±–∏–ª–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: {% count_filtered_autos autos_page %}</p>
    <h2>–ù–û–í–´–ï –ê–í–¢–û üî•</h2>
<div class="recent-autos-list">
    {% get_recent_autos as recent_autos %}
    {% for auto in recent_autos %}
    <div class="recent-auto-item">
        <img src="{{ auto.auto_photos.first.photo.url }}" alt="–§–æ—Ç–æ {{ auto.brand.name }}" class="recent-auto-image">
        <h4>{{ auto.brand.name }} {{ auto.model }}</h4>
        <p>–ì–æ–¥ –≤—ã–ø—É—Å–∫–∞: {{ auto.year }}</p>
        <p>–¶–µ–Ω–∞: {{ auto.price|floatformat:0 }} ‚ÇΩ</p>
    </div>
    {% empty %}
    <p>–ù–µ—Ç –Ω–µ–¥–∞–≤–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π.</p>
    {% endfor %}
</div>

<h2>–ü–æ–¥–æ–±—Ä–∞–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –≤–∞—Å:</h2>
    <div class="autos-list">
        {% for auto_data in autos_with_photos %}
        <div class="auto-item">
            <h3>{{ auto_data.auto.brand.name }} {{ auto_data.auto.model }}</h3>
            <p>–ì–æ–¥ –≤—ã–ø—É—Å–∫–∞: {{ auto_data.auto.year }}</p>
            <p>–¶–µ–Ω–∞: {{ auto_data.auto.price|floatformat:0 }} ‚ÇΩ</p>
            
            {% for photo in auto_data.photos %}
                <img src="{{ photo.photo.url }}" alt="–§–æ—Ç–æ {{ auto_data.auto.brand.name }}">
            {% endfor %}
        </div>
        {% endfor %}
    </div>
</div>

<!-- –°—Å—ã–ª–∫–∏ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏ -->
<div class="pagination">
    {% if autos_page.has_previous %}
        <a href="?page=1">–ü–µ—Ä–≤–∞—è</a>
        <a href="?page={{ autos_page.previous_page_number }}">–ü—Ä–µ–¥—ã–¥—É—â–∞—è</a>
    {% endif %}

    <span>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ autos_page.number }} –∏–∑ {{ autos_page.paginator.num_pages }}</span>

    {% if autos_page.has_next %}
        <a href="?page={{ autos_page.next_page_number }}">–°–ª–µ–¥—É—é—â–∞—è</a>
        <a href="?page={{ autos_page.paginator.num_pages }}">–ü–æ—Å–ª–µ–¥–Ω—è—è</a>
    {% endif %}
</div>
{% endblock %}
